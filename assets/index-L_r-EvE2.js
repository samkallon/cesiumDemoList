const ve="pointerleave",ge="pointermove";var U;(function(t){t.bottom="bottom",t.bottomLeft="bottom-left",t.bottomRight="bottom-right",t.left="left",t.none="none",t.right="right",t.top="top",t.topLeft="top-left",t.topRight="top-right",t.outside="outside",t.inside="inside"})(U||(U={}));function S(t){return typeof t=="string"}function G(t){return typeof t=="number"}function y(t){return Array.isArray(t)}function w(t){return t==null}let ye=Math.random;function se(){return F(ye(),0,1-Number.EPSILON)}function F(t,e,n){return Math.min(Math.max(t,e),n)}function H(t,e,n,i){return Math.floor((t*n+e*i)/(n+i))}function N(t){const e=z(t),n=0;let i=ue(t);return e===i&&(i=n),se()*(e-i)+i}function ue(t){return G(t)?t:t.min}function z(t){return G(t)?t:t.max}function P(t,e){if(t===e||e===void 0&&G(t))return t;const n=ue(t),i=z(t);return e!==void 0?{min:Math.min(n,e),max:Math.max(i,e)}:P(n,i)}function Oe(t,e){const n=t.x-e.x,i=t.y-e.y,o=2;return{dx:n,dy:i,distance:Math.sqrt(n**o+i**o)}}function W(t,e){return Oe(t,e).distance}var V;(function(t){t.auto="auto",t.increase="increase",t.decrease="decrease",t.random="random"})(V||(V={}));var X;(function(t){t.increasing="increasing",t.decreasing="decreasing"})(X||(X={}));var Y;(function(t){t.none="none",t.max="max",t.min="min"})(Y||(Y={}));var Z;(function(t){t.bottom="bottom",t.left="left",t.right="right",t.top="top"})(Z||(Z={}));var ee;(function(t){t.precise="precise",t.percent="percent"})(ee||(ee={}));var te;(function(t){t.max="max",t.min="min",t.random="random"})(te||(te={}));function ze(t,e){const n=_(e,i=>t.matches(i));return y(n)?n.some(i=>i):n}function R(t,e){return t===e||y(e)&&e.indexOf(t)>-1}function Re(t){return Math.floor(se()*t.length)}function J(t,e,n=!0){return t[Re(t)]}function Ce(t,e){return!!le(e,n=>n.enable&&R(t,n.mode))}function Ee(t,e,n){_(e,i=>{const o=i.mode;i.enable&&R(t,o)&&Se(i,n)})}function Se(t,e){const n=t.selectors;_(n,i=>{e(i,t)})}function we(t,e){if(!(!e||!t))return le(t,n=>ze(e,n.selectors))}function _(t,e){return y(t)?t.map((i,o)=>e(i,o)):e(t,0)}function _e(t,e,n){return y(t)?J(t,e,n):t}function le(t,e){return y(t)?t.find((i,o)=>e(i,o)):e(t,0)?t:void 0}function Be(t,e){if(t.version!==e)throw new Error(`The tsParticles version is different from the loaded plugins version. Engine version: ${t.version}. Plugins version: ${e}`)}const Pe="random";function Te(t,e){if(e){for(const n of t.colorManagers.values())if(e.startsWith(n.stringPrefix))return n.parseString(e)}}function ae(t,e,n,i=!0){if(!e)return;const o=S(e)?{value:e}:e;if(S(o.value))return ce(t,o.value,n,i);if(y(o.value))return ae(t,{value:J(o.value,n,i)});for(const r of t.colorManagers.values()){const u=r.handleRangeColor(o);if(u)return u}}function ce(t,e,n,i=!0){if(!e)return;const o=S(e)?{value:e}:e;if(S(o.value))return o.value===Pe?Ie():qe(t,o.value);if(y(o.value))return ce(t,{value:J(o.value,n,i)});for(const r of t.colorManagers.values()){const u=r.handleColor(o);if(u)return u}}function ke(t,e,n,i=!0){const o=ae(t,e,n,i);return o?be(o):void 0}function be(t){const a=t.r/255,l=t.g/255,d=t.b/255,f=Math.max(a,l,d),m=Math.min(a,l,d),h={h:0,l:(f+m)*.5,s:0};return f!==m&&(h.s=h.l<.5?(f-m)/(f+m):(f-m)/(2-f-m),h.h=a===f?(l-d)/(f-m):h.h=l===f?2+(d-a)/(f-m):2*2+(a-l)/(f-m)),h.l*=100,h.s*=100,h.h*=60,h.h<0&&(h.h+=360),h.h>=360&&(h.h-=360),h}function qe(t,e){return Te(t,e)}function ie(t){const u=(t.h%360+360)%360,s=Math.max(0,Math.min(100,t.s)),c=Math.max(0,Math.min(100,t.l)),b=u/360,a=s/100,l=c/100,d=255,f=3;if(s===0){const v=Math.round(l*d);return{r:v,g:v,b:v}}const m=.5,h=2,x=(v,I,g)=>{if(g<0&&g++,g>1&&g--,g*6<1)return v+(I-v)*6*g;if(g*h<1)return I;if(g*f<1*h){const Me=h/f;return v+(I-v)*(Me-g)*6}return v},B=1,p=l<m?l*(B+a):l+a-l*a,q=h*l-p,he=1,Q=he/f,xe=Math.min(d,d*x(q,p,b+Q)),me=Math.min(d,d*x(q,p,b)),pe=Math.min(d,d*x(q,p,b-Q));return{r:Math.round(xe),g:Math.round(me),b:Math.round(pe)}}function Ie(t){return{b:Math.floor(N(P(0,256))),g:Math.floor(N(P(0,256))),r:Math.floor(N(P(0,256)))}}function He(t,e,n,i){let o=t,r=e;return o.r===void 0&&(o=ie(t)),r.r===void 0&&(r=ie(e)),{b:H(o.b,r.b,n,i),g:H(o.g,r.g,n,i),r:H(o.r,r.r,n,i)}}class K{constructor(){this.value=""}static create(e,n){const i=new K;return i.load(e),n!==void 0&&(S(n)||y(n)?i.load({value:n}):i.load(n)),i}load(e){w(e)||w(e.value)||(this.value=e.value)}}var A;(function(t){t.circle="circle",t.rectangle="rectangle"})(A||(A={}));var $;(function(t){t.external="external",t.particles="particles"})($||($={}));var C;(function(t){t.circle="circle",t.rectangle="rectangle"})(C||(C={}));const E=2;class fe{constructor(e,n,i){this.position={x:e,y:n},this.type=i}}class T extends fe{constructor(e,n,i){super(e,n,C.circle),this.radius=i}contains(e){return W(e,this.position)<=this.radius}intersects(e){const n=this.position,i=e.position,o={x:Math.abs(i.x-n.x),y:Math.abs(i.y-n.y)},r=this.radius;if(e instanceof T||e.type===C.circle){const u=e,s=r+u.radius,c=Math.sqrt(o.x**E+o.y**E);return s>c}else if(e instanceof k||e.type===C.rectangle){const u=e,{width:s,height:c}=u.size;return Math.pow(o.x-s,E)+Math.pow(o.y-c,E)<=r**E||o.x<=r+s&&o.y<=r+c||o.x<=s||o.y<=c}return!1}}class k extends fe{constructor(e,n,i,o){super(e,n,C.rectangle),this.size={height:o,width:i}}contains(e){const n=this.size.width,i=this.size.height,o=this.position;return e.x>=o.x&&e.x<=o.x+n&&e.y>=o.y&&e.y<=o.y+i}intersects(e){if(e instanceof T)return e.intersects(this);const n=this.size.width,i=this.size.height,o=this.position,r=e.position,u=e instanceof k?e.size:{width:0,height:0},s=u.width,c=u.height;return r.x<o.x+n&&r.x+s>o.x&&r.y<o.y+i&&r.y+c>o.y}}class Ne{constructor(e){this.type=$.external,this.container=e}}class de{constructor(){this.distance=200,this.duration=.4,this.mix=!1}load(e){if(!w(e)){if(e.distance!==void 0&&(this.distance=e.distance),e.duration!==void 0&&(this.duration=e.duration),e.mix!==void 0&&(this.mix=e.mix),e.opacity!==void 0&&(this.opacity=e.opacity),e.color!==void 0){const n=y(this.color)?void 0:this.color;this.color=_(e.color,i=>K.create(n,i))}e.size!==void 0&&(this.size=e.size)}}}class De extends de{constructor(){super(),this.selectors=[]}load(e){super.load(e),!w(e)&&e.selectors!==void 0&&(this.selectors=e.selectors)}}class Le extends de{load(e){super.load(e),!w(e)&&(this.divs=_(e.divs,n=>{const i=new De;return i.load(n),i}))}}var M;(function(t){t.color="color",t.opacity="opacity",t.size="size"})(M||(M={}));function ne(t,e,n,i){if(e>=n){const o=t+(e-n)*i;return F(o,t,e)}else if(e<n){const o=t-(n-e)*i;return F(o,e,t)}}const O="bubble",D=0,je=0,Fe=2,oe=1,re=1,We=0,Ae=0,L=.5,j=1;class $e extends Ne{constructor(e,n){super(e),this._clickBubble=()=>{var a;const i=this.container,o=i.actualOptions,r=i.interactivity.mouse.clickPosition,u=o.interactivity.modes.bubble;if(!u||!r)return;i.bubble||(i.bubble={});const s=i.retina.bubbleModeDistance;if(!s||s<D)return;const c=i.particles.quadTree.queryCircle(r,s,l=>this.isEnabled(l)),{bubble:b}=i;for(const l of c){if(!b.clicking)continue;l.bubble.inRange=!b.durationEnd;const d=l.getPosition(),f=W(d,r),m=(new Date().getTime()-(i.interactivity.mouse.clickTime??je))/1e3;m>u.duration&&(b.durationEnd=!0),m>u.duration*Fe&&(b.clicking=!1,b.durationEnd=!1);const h={bubbleObj:{optValue:i.retina.bubbleModeSize,value:l.bubble.radius},particlesObj:{optValue:z(l.options.size.value)*i.retina.pixelRatio,value:l.size.value},type:M.size};this._process(l,f,m,h);const x={bubbleObj:{optValue:u.opacity,value:l.bubble.opacity},particlesObj:{optValue:z(l.options.opacity.value),value:((a=l.opacity)==null?void 0:a.value)??oe},type:M.opacity};this._process(l,f,m,x),!b.durationEnd&&f<=s?this._hoverBubbleColor(l,f):delete l.bubble.color}},this._hoverBubble=()=>{const i=this.container,o=i.interactivity.mouse.position,r=i.retina.bubbleModeDistance;if(!r||r<D||!o)return;const u=i.particles.quadTree.queryCircle(o,r,s=>this.isEnabled(s));for(const s of u){s.bubble.inRange=!0;const c=s.getPosition(),b=W(c,o),a=re-b/r;b<=r?a>=Ae&&i.interactivity.status===ge&&(this._hoverBubbleSize(s,a),this._hoverBubbleOpacity(s,a),this._hoverBubbleColor(s,a)):this.reset(s),i.interactivity.status===ve&&this.reset(s)}},this._hoverBubbleColor=(i,o,r)=>{const u=this.container.actualOptions,s=r??u.interactivity.modes.bubble;if(s){if(!i.bubble.finalColor){const c=s.color;if(!c)return;const b=_e(c);i.bubble.finalColor=ke(this._engine,b)}if(i.bubble.finalColor)if(s.mix){i.bubble.color=void 0;const c=i.getFillColor();i.bubble.color=c?be(He(c,i.bubble.finalColor,re-o,o)):i.bubble.finalColor}else i.bubble.color=i.bubble.finalColor}},this._hoverBubbleOpacity=(i,o,r)=>{var d,f;const u=this.container,s=u.actualOptions,c=(r==null?void 0:r.opacity)??((d=s.interactivity.modes.bubble)==null?void 0:d.opacity);if(!c)return;const b=i.options.opacity.value,a=((f=i.opacity)==null?void 0:f.value)??oe,l=ne(a,c,z(b),o);l!==void 0&&(i.bubble.opacity=l)},this._hoverBubbleSize=(i,o,r)=>{const u=this.container,s=r!=null&&r.size?r.size*u.retina.pixelRatio:u.retina.bubbleModeSize;if(s===void 0)return;const c=z(i.options.size.value)*u.retina.pixelRatio,b=i.size.value,a=ne(b,s,c,o);a!==void 0&&(i.bubble.radius=a)},this._process=(i,o,r,u)=>{const s=this.container,c=u.bubbleObj.optValue,b=s.actualOptions,a=b.interactivity.modes.bubble;if(!a||c===void 0)return;const l=a.duration,d=s.retina.bubbleModeDistance,f=u.particlesObj.optValue,m=u.bubbleObj.value,h=u.particlesObj.value??We,x=u.type;if(!(!d||d<D||c===f))if(s.bubble||(s.bubble={}),s.bubble.durationEnd)m&&(x===M.size&&delete i.bubble.radius,x===M.opacity&&delete i.bubble.opacity);else if(o<=d){if((m??h)!==c){const p=h-r*(h-c)/l;x===M.size&&(i.bubble.radius=p),x===M.opacity&&(i.bubble.opacity=p)}}else x===M.size&&delete i.bubble.radius,x===M.opacity&&delete i.bubble.opacity},this._singleSelectorHover=(i,o,r)=>{const u=this.container,s=document.querySelectorAll(o),c=u.actualOptions.interactivity.modes.bubble;!c||!s.length||s.forEach(b=>{const a=b,l=u.retina.pixelRatio,d={x:(a.offsetLeft+a.offsetWidth*L)*l,y:(a.offsetTop+a.offsetHeight*L)*l},f=a.offsetWidth*L*l,m=r.type===A.circle?new T(d.x,d.y,f):new k(a.offsetLeft*l,a.offsetTop*l,a.offsetWidth*l,a.offsetHeight*l),h=u.particles.quadTree.query(m,x=>this.isEnabled(x));for(const x of h){if(!m.contains(x.getPosition()))continue;x.bubble.inRange=!0;const B=c.divs,p=we(B,a);(!x.bubble.div||x.bubble.div!==a)&&(this.clear(x,i,!0),x.bubble.div=a),this._hoverBubbleSize(x,j,p),this._hoverBubbleOpacity(x,j,p),this._hoverBubbleColor(x,j,p)}})},this._engine=n,e.bubble||(e.bubble={}),this.handleClickMode=i=>{i===O&&(e.bubble||(e.bubble={}),e.bubble.clicking=!0)}}clear(e,n,i){e.bubble.inRange&&!i||(delete e.bubble.div,delete e.bubble.opacity,delete e.bubble.radius,delete e.bubble.color)}init(){const e=this.container,n=e.actualOptions.interactivity.modes.bubble;n&&(e.retina.bubbleModeDistance=n.distance*e.retina.pixelRatio,n.size!==void 0&&(e.retina.bubbleModeSize=n.size*e.retina.pixelRatio))}interact(e){const n=this.container.actualOptions,i=n.interactivity.events,o=i.onHover,r=i.onClick,u=o.enable,s=o.mode,c=r.enable,b=r.mode,a=i.onDiv;u&&R(O,s)?this._hoverBubble():c&&R(O,b)?this._clickBubble():Ee(O,a,(l,d)=>this._singleSelectorHover(e,l,d))}isEnabled(e){const n=this.container,i=n.actualOptions,o=n.interactivity.mouse,r=((e==null?void 0:e.interactivity)??i.interactivity).events,{onClick:u,onDiv:s,onHover:c}=r,b=Ce(O,s);return b||c.enable&&o.position||u.enable&&o.clickPosition?R(O,c.mode)||R(O,u.mode)||b:!1}loadModeOptions(e,...n){e.bubble||(e.bubble=new Le);for(const i of n)e.bubble.load(i==null?void 0:i.bubble)}reset(e){e.bubble.inRange=!1}}async function Qe(t,e=!0){Be(t,"3.7.1"),await t.addInteractor("externalBubble",n=>Promise.resolve(new $e(n,t)),e)}export{Le as Bubble,de as BubbleBase,De as BubbleDiv,Qe as loadExternalBubbleInteraction};
