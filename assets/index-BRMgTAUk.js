const O="random",T="mid";var H;(function(i){i.bottom="bottom",i.bottomLeft="bottom-left",i.bottomRight="bottom-right",i.left="left",i.none="none",i.right="right",i.top="top",i.topLeft="top-left",i.topRight="top-right",i.outside="outside",i.inside="inside"})(H||(H={}));function q(i){return typeof i=="string"}function N(i){return typeof i=="number"}function K(i){return Array.isArray(i)}function R(i){return i==null}let dn=Math.random;function $(){return gn(dn(),0,1-Number.EPSILON)}function gn(i,n,e){return Math.min(Math.max(i,n),e)}function I(i,n,e,t){return Math.floor((i*e+n*t)/(e+t))}function z(i){const n=ln(i),e=0;let t=an(i);return n===t&&(t=e),$()*(n-t)+t}function xn(i){return N(i)?i:z(i)}function an(i){return N(i)?i:i.min}function ln(i){return N(i)?i:i.max}function S(i,n){if(i===n||n===void 0&&N(i))return i;const e=an(i),t=ln(i);return n!==void 0?{min:Math.min(e,n),max:Math.max(t,n)}:S(e,t)}function v(i,n){const e=i.x-n.x,t=i.y-n.y,s=2;return{dx:e,dy:t,distance:Math.sqrt(e**s+t**s)}}function P(i,n){return v(i,n).distance}var J;(function(i){i.auto="auto",i.increase="increase",i.decrease="decrease",i.random="random"})(J||(J={}));var Q;(function(i){i.increasing="increasing",i.decreasing="decreasing"})(Q||(Q={}));var U;(function(i){i.none="none",i.max="max",i.min="min"})(U||(U={}));var X;(function(i){i.bottom="bottom",i.left="left",i.right="right",i.top="top"})(X||(X={}));var Y;(function(i){i.precise="precise",i.percent="percent"})(Y||(Y={}));var Z;(function(i){i.max="max",i.min="min",i.random="random"})(Z||(Z={}));function yn(i){return Math.floor($()*i.length)}function cn(i,n,e=!0){return i[yn(i)]}var nn;(function(i){i.darken="darken",i.enlighten="enlighten"})(nn||(nn={}));function pn(i,n){if(n){for(const e of i.colorManagers.values())if(n.startsWith(e.stringPrefix))return e.parseString(n)}}function C(i,n,e,t=!0){if(!n)return;const s=q(n)?{value:n}:n;if(q(s.value))return un(i,s.value,e,t);if(K(s.value))return C(i,{value:cn(s.value,e,t)});for(const r of i.colorManagers.values()){const o=r.handleRangeColor(s);if(o)return o}}function un(i,n,e,t=!0){if(!n)return;const s=q(n)?{value:n}:n;if(q(s.value))return s.value===O?fn():kn(i,s.value);if(K(s.value))return un(i,{value:cn(s.value,e,t)});for(const r of i.colorManagers.values()){const o=r.handleColor(s);if(o)return o}}function kn(i,n){return pn(i,n)}function B(i){const n=(i.h%360+360)%360,e=Math.max(0,Math.min(100,i.s)),t=Math.max(0,Math.min(100,i.l)),s=n/360,r=e/100,o=t/100;if(e===0){const l=Math.round(o*255);return{r:l,g:l,b:l}}const a=(l,x,g)=>(g<0&&g++,g>1&&g--,g*6<1?l+(x-l)*6*g:g*2<1?x:g*3<1*2?l+(x-l)*(.6666666666666666-g)*6:l),c=o<.5?o*(1+r):o+r-o*r,f=2*o-c,y=1/3,h=Math.min(255,255*a(f,c,s+y)),d=Math.min(255,255*a(f,c,s)),u=Math.min(255,255*a(f,c,s-y));return{r:Math.round(h),g:Math.round(d),b:Math.round(u)}}function fn(i){return{b:Math.floor(z(S(0,256))),g:Math.floor(z(S(0,256))),r:Math.floor(z(S(0,256)))}}function j(i,n){return`rgba(${i.r}, ${i.g}, ${i.b}, ${n??1})`}function bn(i,n,e,t){let s=i,r=n;return s.r===void 0&&(s=B(i)),r.r===void 0&&(r=B(n)),{b:I(s.b,r.b,e,t),g:I(s.g,r.g,e,t),r:I(s.r,r.r,e,t)}}function en(i,n,e){if(e===O)return fn();if(e===T){const t=i.getFillColor()??i.getStrokeColor(),s=(n==null?void 0:n.getFillColor())??(n==null?void 0:n.getStrokeColor());if(t&&s&&n)return bn(t,s,i.getRadius(),n.getRadius());{const r=t??s;if(r)return B(r)}}else return e}function mn(i,n,e,t){const s=q(n)?n:n.value;return s===O?t?C(i,{value:s}):e?O:T:s===T?T:C(i,{value:s})}function W(i,n,e){i.beginPath(),i.moveTo(n.x,n.y),i.lineTo(e.x,e.y),i.closePath()}class w{constructor(){this.value=""}static create(n,e){const t=new w;return t.load(n),e!==void 0&&(q(e)||K(e)?t.load({value:e}):t.load(e)),t}load(n){R(n)||R(n.value)||(this.value=n.value)}}var A;(function(i){i.external="external",i.particles="particles"})(A||(A={}));var M;(function(i){i.circle="circle",i.rectangle="rectangle"})(M||(M={}));class hn{constructor(n,e,t){this.position={x:n,y:e},this.type=t}}class L extends hn{constructor(n,e,t){super(n,e,M.circle),this.radius=t}contains(n){return P(n,this.position)<=this.radius}intersects(n){const e=this.position,t=n.position,s={x:Math.abs(t.x-e.x),y:Math.abs(t.y-e.y)},r=this.radius;if(n instanceof L||n.type===M.circle){const o=n,a=r+o.radius,c=Math.sqrt(s.x**2+s.y**2);return a>c}else if(n instanceof E||n.type===M.rectangle){const o=n,{width:a,height:c}=o.size;return Math.pow(s.x-a,2)+Math.pow(s.y-c,2)<=r**2||s.x<=r+a&&s.y<=r+c||s.x<=a||s.y<=c}return!1}}class E extends hn{constructor(n,e,t,s){super(n,e,M.rectangle),this.size={height:s,width:t}}contains(n){const e=this.size.width,t=this.size.height,s=this.position;return n.x>=s.x&&n.x<=s.x+e&&n.y>=s.y&&n.y<=s.y+t}intersects(n){if(n instanceof L)return n.intersects(this);const e=this.size.width,t=this.size.height,s=this.position,r=n.position,o=n instanceof E?n.size:{width:0,height:0},a=o.width,c=o.height;return r.x<s.x+e&&r.x+a>s.x&&r.y<s.y+t&&r.y+c>s.y}}class wn{constructor(n){this.type=A.particles,this.container=n}}const V=2;class Mn extends L{constructor(n,e,t,s){super(n,e,t),this.canvasSize=s,this.canvasSize={...s}}contains(n){const{width:e,height:t}=this.canvasSize,{x:s,y:r}=n;return super.contains(n)||super.contains({x:s-e,y:r})||super.contains({x:s-e,y:r-t})||super.contains({x:s,y:r-t})}intersects(n){if(super.intersects(n))return!0;const e=n,t=n,s={x:n.position.x-this.canvasSize.width,y:n.position.y-this.canvasSize.height};if(t.radius!==void 0){const r=new L(s.x,s.y,t.radius*V);return super.intersects(r)}else if(e.size!==void 0){const r=new E(s.x,s.y,e.size.width*V,e.size.height*V);return super.intersects(r)}return!1}}class qn{constructor(){this.blur=5,this.color=new w,this.color.value="#000",this.enable=!1}load(n){R(n)||(n.blur!==void 0&&(this.blur=n.blur),this.color=w.create(this.color,n.color),n.enable!==void 0&&(this.enable=n.enable))}}class Cn{constructor(){this.enable=!1,this.frequency=1}load(n){R(n)||(n.color!==void 0&&(this.color=w.create(this.color,n.color)),n.enable!==void 0&&(this.enable=n.enable),n.frequency!==void 0&&(this.frequency=n.frequency),n.opacity!==void 0&&(this.opacity=n.opacity))}}class Ln{constructor(){this.blink=!1,this.color=new w,this.color.value="#fff",this.consent=!1,this.distance=100,this.enable=!1,this.frequency=1,this.opacity=1,this.shadow=new qn,this.triangles=new Cn,this.width=1,this.warp=!1}load(n){R(n)||(n.id!==void 0&&(this.id=n.id),n.blink!==void 0&&(this.blink=n.blink),this.color=w.create(this.color,n.color),n.consent!==void 0&&(this.consent=n.consent),n.distance!==void 0&&(this.distance=n.distance),n.enable!==void 0&&(this.enable=n.enable),n.frequency!==void 0&&(this.frequency=n.frequency),n.opacity!==void 0&&(this.opacity=n.opacity),this.shadow.load(n.shadow),this.triangles.load(n.triangles),n.width!==void 0&&(this.width=n.width),n.warp!==void 0&&(this.warp=n.warp))}}const tn=2,_n=1,F={x:0,y:0},vn=0;function Pn(i,n,e,t,s){const{dx:r,dy:o,distance:a}=v(i,n);if(!s||a<=e)return a;const c={x:Math.abs(r),y:Math.abs(o)},f={x:Math.min(c.x,t.width-c.x),y:Math.min(c.y,t.height-c.y)};return Math.sqrt(f.x**tn+f.y**tn)}class Rn extends wn{constructor(n,e){super(n),this._setColor=t=>{if(!t.options.links)return;const s=this._linkContainer,r=t.options.links;let o=r.id===void 0?s.particles.linksColor:s.particles.linksColors.get(r.id);if(o)return;const a=r.color;o=mn(this._engine,a,r.blink,r.consent),r.id===void 0?s.particles.linksColor=o:s.particles.linksColors.set(r.id,o)},this._linkContainer=n,this._engine=e}clear(){}init(){this._linkContainer.particles.linksColor=void 0,this._linkContainer.particles.linksColors=new Map}interact(n){if(!n.options.links)return;n.links=[];const e=n.getPosition(),t=this.container,s=t.canvas.size;if(e.x<F.x||e.y<F.y||e.x>s.width||e.y>s.height)return;const r=n.options.links,o=r.opacity,a=n.retina.linksDistance??vn,c=r.warp;let f;c?f=new Mn(e.x,e.y,a,s):f=new L(e.x,e.y,a);const y=t.particles.quadTree.query(f);for(const h of y){const d=h.options.links;if(n===h||!(d!=null&&d.enable)||r.id!==d.id||h.spawning||h.destroyed||!h.links||n.links.some(g=>g.destination===h)||h.links.some(g=>g.destination===n))continue;const u=h.getPosition();if(u.x<F.x||u.y<F.y||u.x>s.width||u.y>s.height)continue;const l=Pn(e,u,a,s,c&&d.warp);if(l>a)continue;const x=(_n-l/a)*o;this._setColor(n),n.links.push({destination:h,opacity:x})}}isEnabled(n){var e;return!!((e=n.options.links)!=null&&e.enable)}loadParticlesOptions(n,...e){n.links||(n.links=new Ln);for(const t of e)n.links.load(t==null?void 0:t.links)}reset(){}}async function Fn(i,n=!0){await i.addInteractor("particlesLinks",async e=>Promise.resolve(new Rn(e,i)),n)}function Tn(i,n,e,t){i.beginPath(),i.moveTo(n.x,n.y),i.lineTo(e.x,e.y),i.lineTo(t.x,t.y),i.closePath()}function zn(i){let n=!1;const{begin:e,end:t,engine:s,maxDistance:r,context:o,canvasSize:a,width:c,backgroundMask:f,colorLine:y,opacity:h,links:d}=i;if(P(e,t)<=r)W(o,e,t),n=!0;else if(d.warp){let l,x;const g={x:t.x-a.width,y:t.y},b=v(e,g);if(b.distance<=r){const p=e.y-b.dy/b.dx*e.x;l={x:0,y:p},x={x:a.width,y:p}}else{const p={x:t.x,y:t.y-a.height},k=v(e,p);if(k.distance<=r){const m=-(e.y-k.dy/k.dx*e.x)/(k.dy/k.dx);l={x:m,y:0},x={x:m,y:a.height}}else{const _={x:t.x-a.width,y:t.y-a.height},m=v(e,_);if(m.distance<=r){const G=e.y-m.dy/m.dx*e.x;l={x:-G/(m.dy/m.dx),y:G},x={x:l.x+a.width,y:l.y+a.height}}}}l&&x&&(W(o,e,l),W(o,t,x),n=!0)}if(!n)return;o.lineWidth=c,f.enable&&(o.globalCompositeOperation=f.composite),o.strokeStyle=j(y,h);const{shadow:u}=d;if(u.enable){const l=C(s,u.color);l&&(o.shadowBlur=u.blur,o.shadowColor=j(l))}o.stroke()}function Sn(i){const{context:n,pos1:e,pos2:t,pos3:s,backgroundMask:r,colorTriangle:o,opacityTriangle:a}=i;Tn(n,e,t,s),r.enable&&(n.globalCompositeOperation=r.composite),n.fillStyle=j(o,a),n.fill()}function On(i){return i.sort((n,e)=>n-e),i.join("_")}function sn(i,n){const e=On(i.map(s=>s.id));let t=n.get(e);return t===void 0&&(t=$(),n.set(e,t)),t}const rn=0,D=0,on=0,Nn=.5,$n=1;class En{constructor(n,e){this._drawLinkLine=(t,s)=>{const r=t.options.links;if(!(r!=null&&r.enable))return;const o=this._container,a=o.actualOptions,c=s.destination,f=t.getPosition(),y=c.getPosition();let h=s.opacity;o.canvas.draw(d=>{var p;let u;const l=(p=t.options.twinkle)==null?void 0:p.lines;if(l!=null&&l.enable){const k=l.frequency,_=C(this._engine,l.color);$()<k&&_&&(u=_,h=xn(l.opacity))}if(!u){const k=r.id!==void 0?o.particles.linksColors.get(r.id):o.particles.linksColor;u=en(t,c,k)}if(!u)return;const x=t.retina.linksWidth??D,g=t.retina.linksDistance??on,{backgroundMask:b}=a;zn({context:d,width:x,begin:f,end:y,engine:this._engine,maxDistance:g,canvasSize:o.canvas.size,links:r,backgroundMask:b,colorLine:u,opacity:h})})},this._drawLinkTriangle=(t,s,r)=>{const o=t.options.links;if(!(o!=null&&o.enable))return;const a=o.triangles;if(!a.enable)return;const c=this._container,f=c.actualOptions,y=s.destination,h=r.destination,d=a.opacity??(s.opacity+r.opacity)*Nn;d<=rn||c.canvas.draw(u=>{const l=t.getPosition(),x=y.getPosition(),g=h.getPosition(),b=t.retina.linksDistance??on;if(P(l,x)>b||P(g,x)>b||P(g,l)>b)return;let p=C(this._engine,a.color);if(!p){const k=o.id!==void 0?c.particles.linksColors.get(o.id):c.particles.linksColor;p=en(t,y,k)}p&&Sn({context:u,pos1:l,pos2:x,pos3:g,backgroundMask:f.backgroundMask,colorTriangle:p,opacityTriangle:d})})},this._drawTriangles=(t,s,r,o)=>{var f,y,h;const a=r.destination;if(!((f=t.links)!=null&&f.triangles.enable&&((y=a.options.links)!=null&&y.triangles.enable)))return;const c=(h=a.links)==null?void 0:h.filter(d=>{const u=this._getLinkFrequency(a,d.destination);return a.options.links&&u<=a.options.links.frequency&&o.findIndex(x=>x.destination===d.destination)>=0});if(c!=null&&c.length)for(const d of c){const u=d.destination;this._getTriangleFrequency(s,a,u)>t.links.triangles.frequency||this._drawLinkTriangle(s,r,d)}},this._getLinkFrequency=(t,s)=>sn([t,s],this._freqs.links),this._getTriangleFrequency=(t,s,r)=>sn([t,s,r],this._freqs.triangles),this._container=n,this._engine=e,this._freqs={links:new Map,triangles:new Map}}drawParticle(n,e){const{links:t,options:s}=e;if(!(t!=null&&t.length))return;const r=t.filter(o=>s.links&&(s.links.frequency>=$n||this._getLinkFrequency(e,o.destination)<=s.links.frequency));for(const o of r)this._drawTriangles(s,e,o,r),o.opacity>rn&&(e.retina.linksWidth??D)>D&&this._drawLinkLine(e,o)}async init(){this._freqs.links=new Map,this._freqs.triangles=new Map,await Promise.resolve()}particleCreated(n){if(n.links=[],!n.options.links)return;const e=this._container.retina.pixelRatio,{retina:t}=n,{distance:s,width:r}=n.options.links;t.linksDistance=s*e,t.linksWidth=r*e}particleDestroyed(n){n.links=[]}}class In{constructor(n){this.id="links",this._engine=n}getPlugin(n){return Promise.resolve(new En(n,this._engine))}loadOptions(){}needsPlugin(){return!0}}async function Wn(i,n=!0){const e=new In(i);await i.addPlugin(e,n)}async function Dn(i,n=!0){i.checkVersion("3.8.1"),await Fn(i,n),await Wn(i,n)}export{Ln as Links,qn as LinksShadow,Cn as LinksTriangle,Dn as loadParticlesLinksInteraction};
