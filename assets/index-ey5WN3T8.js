const V="pointermove",j="tsParticles - Error";const h={x:0,y:0,z:0},C=2,x=2,_=1,O=0,tt=0;var L;(function(e){e.bottom="bottom",e.bottomLeft="bottom-left",e.bottomRight="bottom-right",e.left="left",e.none="none",e.right="right",e.top="top",e.topLeft="top-left",e.topRight="top-right",e.outside="outside",e.inside="inside"})(L||(L={}));function M(e){return typeof e=="number"}function R(e){return Array.isArray(e)}function et(e){return e==null}class u{constructor(t,i,o){if(this._updateFromAngle=(n,s)=>{this.x=Math.cos(n)*s,this.y=Math.sin(n)*s},!M(t)&&t){this.x=t.x,this.y=t.y;const n=t;this.z=n.z?n.z:h.z}else if(t!==void 0&&i!==void 0)this.x=t,this.y=i,this.z=o??h.z;else throw new Error(`${j} Vector3d not initialized correctly`)}static get origin(){return u.create(h.x,h.y,h.z)}get angle(){return Math.atan2(this.y,this.x)}set angle(t){this._updateFromAngle(t,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(t){this._updateFromAngle(this.angle,t)}static clone(t){return u.create(t.x,t.y,t.z)}static create(t,i,o){return new u(t,i,o)}add(t){return u.create(this.x+t.x,this.y+t.y,this.z+t.z)}addTo(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}copy(){return u.clone(this)}distanceTo(t){return this.sub(t).length}distanceToSq(t){return this.sub(t).getLengthSq()}div(t){return u.create(this.x/t,this.y/t,this.z/t)}divTo(t){this.x/=t,this.y/=t,this.z/=t}getLengthSq(){return this.x**x+this.y**x}mult(t){return u.create(this.x*t,this.y*t,this.z*t)}multTo(t){this.x*=t,this.y*=t,this.z*=t}normalize(){const t=this.length;t!=tt&&this.multTo(_/t)}rotate(t){return u.create(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t),h.z)}setTo(t){this.x=t.x,this.y=t.y;const i=t;this.z=i.z?i.z:h.z}sub(t){return u.create(this.x-t.x,this.y-t.y,this.z-t.z)}subFrom(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}}class d extends u{constructor(t,i){super(t,i,h.z)}static get origin(){return d.create(h.x,h.y)}static clone(t){return d.create(t.x,t.y)}static create(t,i){return new d(t,i)}}let it=Math.random;function nt(){return ot(it(),0,1-Number.EPSILON)}function ot(e,t,i){return Math.min(Math.max(e,t),i)}function st(e){const t=ct(e),i=0;let o=rt(e);return t===o&&(o=i),nt()*(t-o)+o}function z(e){return M(e)?e:st(e)}function rt(e){return M(e)?e:e.min}function ct(e){return M(e)?e:e.max}function J(e,t){const i=e.x-t.x,o=e.y-t.y,n=2;return{dx:i,dy:o,distance:Math.sqrt(i**n+o**n)}}function at(e,t){return J(e,t).distance}function T(e,t,i,o){return d.create(e.x*(i-o)/(i+o)+t.x*C*o/(i+o),e.y)}var B;(function(e){e.auto="auto",e.increase="increase",e.decrease="decrease",e.random="random"})(B||(B={}));var H;(function(e){e.increasing="increasing",e.decreasing="decreasing"})(H||(H={}));var $;(function(e){e.none="none",e.max="max",e.min="min"})($||($={}));var A;(function(e){e.bottom="bottom",e.left="left",e.right="right",e.top="top"})(A||(A={}));var N;(function(e){e.precise="precise",e.percent="percent"})(N||(N={}));var D;(function(e){e.max="max",e.min="min",e.random="random"})(D||(D={}));function W(e){const t={bounced:!1},{pSide:i,pOtherSide:o,rectSide:n,rectOtherSide:s,velocity:r,factor:c}=e;return o.min<s.min||o.min>s.max||o.max<s.min||o.max>s.max||(i.max>=n.min&&i.max<=(n.max+n.min)*.5&&r>O||i.min<=n.max&&i.min>(n.max+n.min)*.5&&r<O)&&(t.velocity=r*-c,t.bounced=!0),t}function S(e,t){return e===t||R(t)&&t.indexOf(e)>-1}function K(e,t){return{bottom:e.y+t,left:e.x-t,right:e.x+t,top:e.y-t}}function ut(e,t){return!!mt(t,i=>i.enable&&S(e,i.mode))}function ht(e,t,i){Q(t,o=>{const n=o.mode;o.enable&&S(e,n)&&lt(o,i)})}function lt(e,t){const i=e.selectors;Q(i,o=>{t(o,e)})}function ft(e){return{position:e.getPosition(),radius:e.getRadius(),mass:e.getMass(),velocity:e.velocity,factor:d.create(z(e.options.bounce.horizontal.value),z(e.options.bounce.vertical.value))}}function dt(e,t){const{x:i,y:o}=e.velocity.sub(t.velocity),[n,s]=[e.position,t.position],{dx:r,dy:c}=J(s,n);if(i*r+o*c<0)return;const l=-Math.atan2(c,r),f=e.mass,p=t.mass,q=e.velocity.rotate(l),I=t.velocity.rotate(l),Z=T(q,I,f,p),k=T(I,q,f,p),P=Z.rotate(-l),F=k.rotate(-l);e.velocity.x=P.x*e.factor.x,e.velocity.y=P.y*e.factor.y,t.velocity.x=F.x*t.factor.x,t.velocity.y=F.y*t.factor.y}function xt(e,t){const i=e.getPosition(),o=e.getRadius(),n=K(i,o),s=e.options.bounce,r=W({pSide:{min:n.left,max:n.right},pOtherSide:{min:n.top,max:n.bottom},rectSide:{min:t.left,max:t.right},rectOtherSide:{min:t.top,max:t.bottom},velocity:e.velocity.x,factor:z(s.horizontal.value)});r.bounced&&(r.velocity!==void 0&&(e.velocity.x=r.velocity),r.position!==void 0&&(e.position.x=r.position));const c=W({pSide:{min:n.top,max:n.bottom},pOtherSide:{min:n.left,max:n.right},rectSide:{min:t.top,max:t.bottom},rectOtherSide:{min:t.left,max:t.right},velocity:e.velocity.y,factor:z(s.vertical.value)});c.bounced&&(c.velocity!==void 0&&(e.velocity.y=c.velocity),c.position!==void 0&&(e.position.y=c.position))}function Q(e,t){return R(e)?e.map((o,n)=>t(o,n)):t(e,0)}function mt(e,t){return R(e)?e.find((o,n)=>t(o,n)):t(e,0)?e:void 0}var w;(function(e){e.circle="circle",e.rectangle="rectangle"})(w||(w={}));var E;(function(e){e.external="external",e.particles="particles"})(E||(E={}));var m;(function(e){e.circle="circle",e.rectangle="rectangle"})(m||(m={}));class U{constructor(t,i,o){this.position={x:t,y:i},this.type=o}}class y extends U{constructor(t,i,o){super(t,i,m.circle),this.radius=o}contains(t){return at(t,this.position)<=this.radius}intersects(t){const i=this.position,o=t.position,n={x:Math.abs(o.x-i.x),y:Math.abs(o.y-i.y)},s=this.radius;if(t instanceof y||t.type===m.circle){const r=t,c=s+r.radius,a=Math.sqrt(n.x**x+n.y**x);return c>a}else if(t instanceof g||t.type===m.rectangle){const r=t,{width:c,height:a}=r.size;return Math.pow(n.x-c,x)+Math.pow(n.y-a,x)<=s**x||n.x<=s+c&&n.y<=s+a||n.x<=c||n.y<=a}return!1}}class g extends U{constructor(t,i,o,n){super(t,i,m.rectangle),this.size={height:n,width:o}}contains(t){const i=this.size.width,o=this.size.height,n=this.position;return t.x>=n.x&&t.x<=n.x+i&&t.y>=n.y&&t.y<=n.y+o}intersects(t){if(t instanceof y)return t.intersects(this);const i=this.size.width,o=this.size.height,n=this.position,s=t.position,r=t instanceof g?t.size:{width:0,height:0},c=r.width,a=r.height;return s.x<n.x+i&&s.x+c>n.x&&s.y<n.y+o&&s.y+a>n.y}}class yt{constructor(t){this.type=E.external,this.container=t}}const gt=2,v=.5,pt=Math.PI*v,G=2,X=10,bt=0;function Y(e,t,i,o,n){const s=e.particles.quadTree.query(o,n);for(const r of s)o instanceof y?dt(ft(r),{position:t,mass:i**gt*pt,velocity:d.origin,factor:d.origin}):o instanceof g&&xt(r,K(t,i))}function vt(e,t,i,o){const n=document.querySelectorAll(t);n.length&&n.forEach(s=>{const r=s,c=e.retina.pixelRatio,a={x:(r.offsetLeft+r.offsetWidth*v)*c,y:(r.offsetTop+r.offsetHeight*v)*c},l=r.offsetWidth*v*c,f=X*c,p=i.type===w.circle?new y(a.x,a.y,l+f):new g(r.offsetLeft*c-f,r.offsetTop*c-f,r.offsetWidth*c+f*G,r.offsetHeight*c+f*G);o(a,l,p)})}function zt(e,t,i,o){ht(i,t,(n,s)=>vt(e,n,s,(r,c,a)=>Y(e,r,c,a,o)))}function St(e,t){const i=e.retina.pixelRatio,o=X*i,n=e.interactivity.mouse.position,s=e.retina.bounceModeDistance;!s||s<bt||!n||Y(e,n,s,new y(n.x,n.y,s+o),t)}class Mt{constructor(){this.distance=200}load(t){et(t)||t.distance!==void 0&&(this.distance=t.distance)}}const b="bounce";class wt extends yt{constructor(t){super(t)}clear(){}init(){const t=this.container,i=t.actualOptions.interactivity.modes.bounce;i&&(t.retina.bounceModeDistance=i.distance*t.retina.pixelRatio)}interact(){const t=this.container,i=t.actualOptions,o=i.interactivity.events,n=t.interactivity.status===V,s=o.onHover.enable,r=o.onHover.mode,c=o.onDiv;n&&s&&S(b,r)?St(this.container,a=>this.isEnabled(a)):zt(this.container,c,b,a=>this.isEnabled(a))}isEnabled(t){const i=this.container,o=i.actualOptions,n=i.interactivity.mouse,s=((t==null?void 0:t.interactivity)??o.interactivity).events,r=s.onDiv;return!!n.position&&s.onHover.enable&&S(b,s.onHover.mode)||ut(b,r)}loadModeOptions(t,...i){t.bounce||(t.bounce=new Mt);for(const o of i)t.bounce.load(o==null?void 0:o.bounce)}reset(){}}async function Et(e,t=!0){e.checkVersion("3.8.1"),await e.addInteractor("externalBounce",i=>Promise.resolve(new wt(i)),t)}export{Mt as Bounce,Et as loadExternalBounceInteraction};
