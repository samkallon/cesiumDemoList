const _="pointermove",E="tsParticles - Error";const f={x:0,y:0,z:0},v=2,j=1,V=0;var N;(function(t){t.bottom="bottom",t.bottomLeft="bottom-left",t.bottomRight="bottom-right",t.left="left",t.none="none",t.right="right",t.top="top",t.topLeft="top-left",t.topRight="top-right",t.outside="outside",t.inside="inside"})(N||(N={}));function T(t){return typeof t=="number"}function k(t){return Array.isArray(t)}function C(t){return t==null}class d{constructor(e,s,i){if(this._updateFromAngle=(n,r)=>{this.x=Math.cos(n)*r,this.y=Math.sin(n)*r},!T(e)&&e){this.x=e.x,this.y=e.y;const n=e;this.z=n.z?n.z:f.z}else if(e!==void 0&&s!==void 0)this.x=e,this.y=s,this.z=i??f.z;else throw new Error(`${E} Vector3d not initialized correctly`)}static get origin(){return d.create(f.x,f.y,f.z)}get angle(){return Math.atan2(this.y,this.x)}set angle(e){this._updateFromAngle(e,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(e){this._updateFromAngle(this.angle,e)}static clone(e){return d.create(e.x,e.y,e.z)}static create(e,s,i){return new d(e,s,i)}add(e){return d.create(this.x+e.x,this.y+e.y,this.z+e.z)}addTo(e){this.x+=e.x,this.y+=e.y,this.z+=e.z}copy(){return d.clone(this)}distanceTo(e){return this.sub(e).length}distanceToSq(e){return this.sub(e).getLengthSq()}div(e){return d.create(this.x/e,this.y/e,this.z/e)}divTo(e){this.x/=e,this.y/=e,this.z/=e}getLengthSq(){return this.x**v+this.y**v}mult(e){return d.create(this.x*e,this.y*e,this.z*e)}multTo(e){this.x*=e,this.y*=e,this.z*=e}normalize(){const e=this.length;e!=V&&this.multTo(j/e)}rotate(e){return d.create(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e),f.z)}setTo(e){this.x=e.x,this.y=e.y;const s=e;this.z=s.z?s.z:f.z}sub(e){return d.create(this.x-e.x,this.y-e.y,this.z-e.z)}subFrom(e){this.x-=e.x,this.y-=e.y,this.z-=e.z}}class b extends d{constructor(e,s){super(e,s,f.z)}static get origin(){return b.create(f.x,f.y)}static clone(e){return b.create(e.x,e.y)}static create(e,s){return new b(e,s)}}function ee(t,e,s){return Math.min(Math.max(t,e),s)}function Q(t,e){const s=t.x-e.x,i=t.y-e.y,n=2;return{dx:s,dy:i,distance:Math.sqrt(s**n+i**n)}}function te(t,e){return Q(t,e).distance}var W;(function(t){t.auto="auto",t.increase="increase",t.decrease="decrease",t.random="random"})(W||(W={}));var $;(function(t){t.increasing="increasing",t.decreasing="decreasing"})($||($={}));var D;(function(t){t.none="none",t.max="max",t.min="min"})(D||(D={}));var G;(function(t){t.bottom="bottom",t.left="left",t.right="right",t.top="top"})(G||(G={}));var J;(function(t){t.precise="precise",t.percent="percent"})(J||(J={}));var K;(function(t){t.max="max",t.min="min",t.random="random"})(K||(K={}));function se(t,e){const s=M(e,i=>t.matches(i));return k(s)?s.some(i=>i):s}function z(t,e){return t===e||k(e)&&e.indexOf(t)>-1}function ie(t,e){return!!U(e,s=>s.enable&&z(t,s.mode))}function ne(t,e,s){M(e,i=>{const n=i.mode;i.enable&&z(t,n)&&re(i,s)})}function re(t,e){const s=t.selectors;M(s,i=>{e(i,t)})}function oe(t,e){if(!(!e||!t))return U(t,s=>se(e,s.selectors))}function M(t,e){return k(t)?t.map((i,n)=>e(i,n)):e(t,0)}function U(t,e){return k(t)?t.find((i,n)=>e(i,n)):e(t,0)?t:void 0}var F;(function(t){t.circle="circle",t.rectangle="rectangle"})(F||(F={}));var A;(function(t){t.external="external",t.particles="particles"})(A||(A={}));var I;(function(t){t.circle="circle",t.rectangle="rectangle"})(I||(I={}));class X{constructor(e,s,i){this.position={x:e,y:s},this.type=i}}class q extends X{constructor(e,s,i){super(e,s,I.circle),this.radius=i}contains(e){return te(e,this.position)<=this.radius}intersects(e){const s=this.position,i=e.position,n={x:Math.abs(i.x-s.x),y:Math.abs(i.y-s.y)},r=this.radius;if(e instanceof q||e.type===I.circle){const o=e,c=r+o.radius,u=Math.sqrt(n.x**v+n.y**v);return c>u}else if(e instanceof S||e.type===I.rectangle){const o=e,{width:c,height:u}=o.size;return Math.pow(n.x-c,v)+Math.pow(n.y-u,v)<=r**v||n.x<=r+c&&n.y<=r+u||n.x<=c||n.y<=u}return!1}}class S extends X{constructor(e,s,i,n){super(e,s,I.rectangle),this.size={height:n,width:i}}contains(e){const s=this.size.width,i=this.size.height,n=this.position;return e.x>=n.x&&e.x<=n.x+s&&e.y>=n.y&&e.y<=n.y+i}intersects(e){if(e instanceof q)return e.intersects(this);const s=this.size.width,i=this.size.height,n=this.position,r=e.position,o=e instanceof S?e.size:{width:0,height:0},c=o.width,u=o.height;return r.x<n.x+s&&r.x+c>n.x&&r.y<n.y+i&&r.y+u>n.y}}class ce{constructor(e){this.type=A.external,this.container=e}}var B;(function(t){t.easeInBack="ease-in-back",t.easeInCirc="ease-in-circ",t.easeInCubic="ease-in-cubic",t.easeInLinear="ease-in-linear",t.easeInQuad="ease-in-quad",t.easeInQuart="ease-in-quart",t.easeInQuint="ease-in-quint",t.easeInExpo="ease-in-expo",t.easeInSine="ease-in-sine",t.easeOutBack="ease-out-back",t.easeOutCirc="ease-out-circ",t.easeOutCubic="ease-out-cubic",t.easeOutLinear="ease-out-linear",t.easeOutQuad="ease-out-quad",t.easeOutQuart="ease-out-quart",t.easeOutQuint="ease-out-quint",t.easeOutExpo="ease-out-expo",t.easeOutSine="ease-out-sine",t.easeInOutBack="ease-in-out-back",t.easeInOutCirc="ease-in-out-circ",t.easeInOutCubic="ease-in-out-cubic",t.easeInOutLinear="ease-in-out-linear",t.easeInOutQuad="ease-in-out-quad",t.easeInOutQuart="ease-in-out-quart",t.easeInOutQuint="ease-in-out-quint",t.easeInOutExpo="ease-in-out-expo",t.easeInOutSine="ease-in-out-sine"})(B||(B={}));class Y{constructor(){this.distance=200,this.duration=.4,this.factor=100,this.speed=1,this.maxSpeed=50,this.easing=B.easeOutQuad}load(e){C(e)||(e.distance!==void 0&&(this.distance=e.distance),e.duration!==void 0&&(this.duration=e.duration),e.easing!==void 0&&(this.easing=e.easing),e.factor!==void 0&&(this.factor=e.factor),e.speed!==void 0&&(this.speed=e.speed),e.maxSpeed!==void 0&&(this.maxSpeed=e.maxSpeed))}}class ue extends Y{constructor(){super(),this.selectors=[]}load(e){super.load(e),!C(e)&&e.selectors!==void 0&&(this.selectors=e.selectors)}}class ae extends Y{load(e){super.load(e),!C(e)&&(this.divs=M(e.divs,s=>{const i=new ue;return i.load(s),i}))}}const y="repulse",le=0,he=6,de=3,fe=2,pe=0,xe=0,me=1,L=.5;class ye extends ce{constructor(e,s){super(s),this._clickRepulse=()=>{const i=this.container,n=i.actualOptions.interactivity.modes.repulse;if(!n)return;const r=i.repulse??{particles:[]};if(r.finish||(r.count||(r.count=0),r.count++,r.count===i.particles.count&&(r.finish=!0)),r.clicking){const o=i.retina.repulseModeDistance;if(!o||o<le)return;const c=Math.pow(o/he,de),u=i.interactivity.mouse.clickPosition;if(u===void 0)return;const a=new q(u.x,u.y,c),l=i.particles.quadTree.query(a,h=>this.isEnabled(h));for(const h of l){const{dx:p,dy:m,distance:O}=Q(u,h.position),x=O**fe,g=n.speed,P=-c*g/x;if(x<=c){r.particles.push(h);const w=b.create(p,m);w.length=P,h.velocity.setTo(w)}}}else if(r.clicking===!1){for(const o of r.particles)o.velocity.setTo(o.initialVelocity);r.particles=[]}},this._hoverRepulse=()=>{const i=this.container,n=i.interactivity.mouse.position,r=i.retina.repulseModeDistance;!r||r<pe||!n||this._processRepulse(n,r,new q(n.x,n.y,r))},this._processRepulse=(i,n,r,o)=>{const c=this.container,u=c.particles.quadTree.query(r,g=>this.isEnabled(g)),a=c.actualOptions.interactivity.modes.repulse;if(!a)return;const{easing:l,speed:h,factor:p,maxSpeed:m}=a,O=this._engine.getEasing(l),x=((o==null?void 0:o.speed)??h)*p;for(const g of u){const{dx:P,dy:w,distance:R}=Q(g.position,i),H=ee(O(me-R/n)*x,xe,m),Z=b.create(R?P/R*H:x,R?w/R*H:x);g.position.addTo(Z)}},this._singleSelectorRepulse=(i,n)=>{const r=this.container,o=r.actualOptions.interactivity.modes.repulse;if(!o)return;const c=document.querySelectorAll(i);c.length&&c.forEach(u=>{const a=u,l=r.retina.pixelRatio,h={x:(a.offsetLeft+a.offsetWidth*L)*l,y:(a.offsetTop+a.offsetHeight*L)*l},p=a.offsetWidth*L*l,m=n.type===F.circle?new q(h.x,h.y,p):new S(a.offsetLeft*l,a.offsetTop*l,a.offsetWidth*l,a.offsetHeight*l),O=o.divs,x=oe(O,a);this._processRepulse(h,p,m,x)})},this._engine=e,s.repulse||(s.repulse={particles:[]}),this.handleClickMode=i=>{const n=this.container.actualOptions,r=n.interactivity.modes.repulse;if(!r||i!==y)return;s.repulse||(s.repulse={particles:[]});const o=s.repulse;o.clicking=!0,o.count=0;for(const c of s.repulse.particles)this.isEnabled(c)&&c.velocity.setTo(c.initialVelocity);o.particles=[],o.finish=!1,setTimeout(()=>{s.destroyed||(o.clicking=!1)},r.duration*1e3)}}clear(){}init(){const e=this.container,s=e.actualOptions.interactivity.modes.repulse;s&&(e.retina.repulseModeDistance=s.distance*e.retina.pixelRatio)}interact(){const e=this.container,s=e.actualOptions,i=e.interactivity.status===_,n=s.interactivity.events,r=n.onHover,o=r.enable,c=r.mode,u=n.onClick,a=u.enable,l=u.mode,h=n.onDiv;i&&o&&z(y,c)?this._hoverRepulse():a&&z(y,l)?this._clickRepulse():ne(y,h,(p,m)=>this._singleSelectorRepulse(p,m))}isEnabled(e){const s=this.container,i=s.actualOptions,n=s.interactivity.mouse,r=((e==null?void 0:e.interactivity)??i.interactivity).events,o=r.onDiv,c=r.onHover,u=r.onClick,a=ie(y,o);if(!(a||c.enable&&n.position||u.enable&&n.clickPosition))return!1;const l=c.mode,h=u.mode;return z(y,l)||z(y,h)||a}loadModeOptions(e,...s){e.repulse||(e.repulse=new ae);for(const i of s)e.repulse.load(i==null?void 0:i.repulse)}reset(){}}async function ve(t,e=!0){t.checkVersion("3.8.1"),await t.addInteractor("externalRepulse",s=>Promise.resolve(new ye(t,s)),e)}export{ae as Repulse,Y as RepulseBase,ue as RepulseDiv,ve as loadExternalRepulseInteraction};
