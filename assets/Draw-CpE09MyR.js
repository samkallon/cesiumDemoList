class a{constructor(e){this.viewer=e,this.drawingMode="polygon",this.activeShapePoints=[],this.activeShape=null,this.floatingPoint=null}removaEntitiesAndPrimitivesByName(e){this.getEntitiesByName(e).forEach(i=>{this.viewer.entities.remove(i)}),this.viewer.scene.primitives._primitives.filter(i=>i.name===e).forEach(i=>{this.viewer.scene.primitives.remove(i)})}getEntitiesByName(e){return this.viewer.entities._entities._array.filter(s=>s.name===e)}createPoint(e){return this.viewer.entities.add({name:"drawPoint",position:e,point:{color:Cesium.Color.WHITE,pixelSize:10}})}drawShape(e){let t;return this.drawingMode==="line"?t=this.viewer.entities.add({name:"drawLine",polyline:{positions:e,clampToGround:!0,width:3}}):this.drawingMode==="polygon"&&(t=this.viewer.entities.add({name:"drawPolygon",polygon:{hierarchy:e,material:new Cesium.ColorMaterialProperty(Cesium.Color.WHITE.withAlpha(.7))}})),t}startDraw(e){this.activeShapePoints=[],e&&(this.drawingMode=e);const t=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);t.setInputAction(s=>{const i=this.viewer.scene.pickPosition(s.position);if(Cesium.defined(i)){if(this.activeShapePoints.length===0){this.floatingPoint=this.createPoint(i),this.activeShapePoints.push(i);const n=new Cesium.CallbackProperty(function(){return this.drawingMode==="polygon"?new Cesium.PolygonHierarchy(this.activeShapePoints):this.activeShapePoints},!1);this.activeShape=this.drawShape(n)}this.activeShapePoints.push(i),this.createPoint(i)}},Cesium.ScreenSpaceEventType.LEFT_CLICK),t.setInputAction(s=>{if(Cesium.defined(this.floatingPoint)){const i=this.viewer.scene.pickPosition(s.endPosition);Cesium.defined(i)&&(this.floatingPoint.position.setValue(i),this.activeShapePoints.pop(),this.activeShapePoints.push(i),console.log(this.activeShapePoints))}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),t.setInputAction(s=>{this.terminateShape()},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}terminateShape(){this.activeShapePoints.pop(),this.drawShape(this.activeShapePoints),this.viewer.entities.remove(this.floatingPoint),this.viewer.entities.remove(this.activeShape),this.floatingPoint=void 0,this.activeShape=void 0}clear(){this.removaEntitiesAndPrimitivesByName("drawPolygon",this.viewer),this.removaEntitiesAndPrimitivesByName("drawLine",this.viewer),this.removaEntitiesAndPrimitivesByName("drawPoint",this.viewer)}}export{a as D};
