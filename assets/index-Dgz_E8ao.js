const E="random";var L;(function(e){e.bottom="bottom",e.bottomLeft="bottom-left",e.bottomRight="bottom-right",e.left="left",e.none="none",e.right="right",e.top="top",e.topLeft="top-left",e.topRight="top-right",e.outside="outside",e.inside="inside"})(L||(L={}));function m(e){return typeof e=="string"}function h(e){return typeof e=="number"}function y(e){return Array.isArray(e)}let N=Math.random;function c(){return F(N(),0,1-Number.EPSILON)}function F(e,n,t){return Math.min(Math.max(e,n),t)}function a(e){const n=M(e),t=0;let i=b(e);return n===i&&(i=t),c()*(n-i)+i}function f(e){return h(e)?e:a(e)}function b(e){return h(e)?e:e.min}function M(e){return h(e)?e:e.max}function u(e,n){if(e===n||n===void 0&&h(e))return e;const t=b(e),i=M(e);return n!==void 0?{min:Math.min(t,n),max:Math.max(i,n)}:u(t,i)}var T;(function(e){e.auto="auto",e.increase="increase",e.decrease="decrease",e.random="random"})(T||(T={}));var l;(function(e){e.increasing="increasing",e.decreasing="decreasing"})(l||(l={}));var C;(function(e){e.none="none",e.max="max",e.min="min"})(C||(C={}));var k;(function(e){e.bottom="bottom",e.left="left",e.right="right",e.top="top"})(k||(k={}));var S;(function(e){e.precise="precise",e.percent="percent"})(S||(S={}));var P;(function(e){e.max="max",e.min="min",e.random="random"})(P||(P={}));function U(e){return Math.floor(c()*e.length)}function v(e,n,t=!0){return e[n!==void 0&&t?n%e.length:U(e)]}function I(e,n,t){return y(e)?v(e,n,t):e}function W(e,n){if(n){for(const t of e.colorManagers.values())if(n.startsWith(t.stringPrefix))return t.parseString(n)}}function H(e,n,t,i=!0){if(!n)return;const o=m(n)?{value:n}:n;if(m(o.value))return _(e,o.value,t,i);if(y(o.value))return H(e,{value:v(o.value,t,i)});for(const s of e.colorManagers.values()){const r=s.handleRangeColor(o);if(r)return r}}function _(e,n,t,i=!0){if(!n)return;const o=m(n)?{value:n}:n;if(m(o.value))return o.value===E?B():z(e,o.value);if(y(o.value))return _(e,{value:v(o.value,t,i)});for(const s of e.colorManagers.values()){const r=s.handleColor(o);if(r)return r}}function A(e,n,t,i=!0){const o=H(e,n,t,i);return o?q(o):void 0}function q(e){const n=e.r/255,t=e.g/255,i=e.b/255,o=Math.max(n,t,i),s=Math.min(n,t,i),r={h:0,l:(o+s)*.5,s:0};return o!==s&&(r.s=r.l<.5?(o-s)/(o+s):(o-s)/(2-o-s),r.h=n===o?(t-i)/(o-s):r.h=t===o?2+(i-n)/(o-s):2*2+(n-t)/(o-s)),r.l*=100,r.s*=100,r.h*=60,r.h<0&&(r.h+=360),r.h>=360&&(r.h-=360),r}function z(e,n){return W(e,n)}function B(e){return{b:Math.floor(a(u(0,256))),g:Math.floor(a(u(0,256))),r:Math.floor(a(u(0,256)))}}function G(e,n,t){const i={h:{enable:!1,value:e.h},s:{enable:!1,value:e.s},l:{enable:!1,value:e.l}};return n&&(d(i.h,n.h,t),d(i.s,n.s,t),d(i.l,n.l,t)),i}function d(e,n,t){e.enable=n.enable,e.enable?(e.velocity=f(n.speed)/100*t,e.decay=1-f(n.decay),e.status=l.increasing,e.loops=0,e.maxLoops=f(n.count),e.time=0,e.delayTime=f(n.delay)*1e3,n.sync||(e.velocity*=c(),e.value*=c()),e.initialValue=e.value,e.offset=u(n.offset)):e.velocity=0}function x(e,n,t,i){if(!e||!e.enable||(e.maxLoops??0)>0&&(e.loops??0)>(e.maxLoops??0)||(e.time||(e.time=0),(e.delayTime??0)>0&&e.time<(e.delayTime??0)&&(e.time+=i.value),(e.delayTime??0)>0&&e.time<(e.delayTime??0)))return;const w=e.offset?a(e.offset):0,p=(e.velocity??0)*i.factor+w*3.6,R=e.decay??1,g=M(n),O=b(n);!t||e.status===l.increasing?(e.value+=p,e.value>g&&(e.loops||(e.loops=0),e.loops++,t?e.status=l.decreasing:e.value-=g)):(e.value-=p,e.value<0&&(e.loops||(e.loops=0),e.loops++,e.status=l.increasing)),e.velocity&&R!==1&&(e.velocity*=R),e.value=F(e.value,O,g)}function J(e,n){if(!e)return;const{h:t,s:i,l:o}=e,s={h:{min:0,max:360},s:{min:0,max:100},l:{min:0,max:100}};t&&x(t,s.h,!1,n),i&&x(i,s.s,!0,n),o&&x(o,s.l,!0,n)}const K=1;class Q{constructor(n,t){this._container=n,this._engine=t}init(n){var r;const t=this._container,i=n.options,o=I(i.stroke,n.id,i.reduceDuplicates);n.strokeWidth=f(o.width)*t.retina.pixelRatio,n.strokeOpacity=f(o.opacity??K),n.strokeAnimation=(r=o.color)==null?void 0:r.animation;const s=A(this._engine,o.color)??n.getFillColor();s&&(n.strokeColor=G(s,n.strokeAnimation,t.retina.reduceFactor))}isEnabled(n){const t=n.strokeAnimation,{strokeColor:i}=n;return!n.destroyed&&!n.spawning&&!!t&&((i==null?void 0:i.h.value)!==void 0&&i.h.enable||(i==null?void 0:i.s.value)!==void 0&&i.s.enable||(i==null?void 0:i.l.value)!==void 0&&i.l.enable)}update(n,t){this.isEnabled(n)&&J(n.strokeColor,t)}}async function j(e,n=!0){e.checkVersion("3.8.1"),await e.addParticleUpdater("strokeColor",t=>Promise.resolve(new Q(t,e)),n)}export{j as loadStrokeColorUpdater};
